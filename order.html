<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order</title>
  <link rel="stylesheet" href="css/desktop.css" media="screen and (min-width: 768px)">
  <link rel="stylesheet" href="css/mobile.css" media="screen and (max-width: 767px)">
  <script src="js/script.js"></script>
</head>

<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>



  <!-- Nav -->
  <nav>
    <img src="images/logo.png" alt="Bruno's-Pizza-Logo" class="nav-logo">
    <ul class="navbar">
      <li><a href="index.html">Home</a></li>
      <li><a href="register.html">Register</a></li>
      <li><a href="order.html">Order</a></li>
      <li><a href="features.html">Features</a></li>
    </ul>
  </nav>

  <!-- Header -->
  <header>
    <h1>Order</h1>
  </header>

  <main id="main-content">

    <div class="center-container">
      <p>We would love to take your order</p>
      <p>Fill out the form here</p>
    </div>

    <form id="order-form" method="post" action="http://mercury.swin.edu.au/it000000/cos10005/regtest.php">

      <p>
        <label for="delivery-method">Delivery or Pick-up:</label><br>
        <input type="radio" id="pickup" name="delivery-method" value="pickup" checked onclick="toggleAddress(false)" />
        <label for="pickup">Pick-up</label><br>

        <input type="radio" id="delivery" name="delivery-method" value="delivery" onclick="toggleAddress(true)" />
        <label for="delivery">Delivery</label>
      </p>

      <!-- Only shown if user selects "Delivery" radio button -->
      <p id="delivery-address">
        <label for="address">Delivery Address:</label>
        <input type="text" id="address" name="address" /><br><br>

        <label for="postcode">Post Code:</label>
        <input type="number" id="postcode" name="postcode" />
      </p>

      <p>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" />
      </p>

      <p>
        <label for="order">Your Order:</label>
        <textarea id="order" name="order" rows="4"></textarea>
      </p>




      <p>
        <label for="billing-address">Billing Address:</label>
        <input type="checkbox" id="same-as-delivery" name="same-as-delivery" onclick="copyAddress()" />
        <label for="same-as-delivery"><em>Same as delivery address</em></label>
        <input type="text" id="billing-address" name="billing-address" />
      </p>

      <p>
        <label for="contact-number">Contact Number:</label>
        <input type="tel" id="contact-number" name="contact-number" />
      </p>


      <p>
        <label for="email">Email for Receipt:</label>
        <input type="email" id="email" name="email" />
      </p>

      <p>
        <label for="payment-method">Payment Method:</label><br>
        <input type="radio" id="pay-on-pickup" name="payment-method" checked value="pay-on-pickup"
          onclick="togglePayment(false)" />
        <label for="pay-on-pickup">Pay on Pick-up</label><br>

        <input type="radio" id="pay-online" name="payment-method" value="pay-online" onclick="togglePayment(true)" />
        <label for="pay-online">Pay Online</label>
      </p>

      <!-- Only shown if user selects "Pay Online" radio button -->
      <div id="credit-card-info">
        <p>
          <label for="card-type">Card Type:</label>
          <select id="card-type" name="card-type" onchange="updateCardNumberLength()">
            <option value="">Select Card Type</option>
            <option value="visa">Visa</option>
            <option value="mastercard">MasterCard</option>
            <option value="amex">American Express</option>
          </select>
        </p>
        <p>
          <label for="card-name">Name on Card:</label>
          <input type="text" id="card-name" name="card-name" />
        </p>
        <p>
          <label for="card-number">Credit Card Number:</label>
          <input type="number" id="card-number" name="card-number" />
        </p>
        <p>
          <label for="expiry-date">Expiry Date:</label>
          <input type="text" id="expiry-date" name="expiry-date" placeholder="MM/YY" />
        </p>
        <p>
          <label for="cvv">CVV:</label>
          <input type="text" id="cvv" name="cvv" />
        </p>
      </div>

      <p>
        <input type="submit" value="Submit Order" />
        <input type="reset" value="Reset" />
      </p>
    </form>
  </main>


  <footer>
    &copy; 2024 - Bruno's Pizza
  </footer>

  <script>
    // Toggle Delivery Address field
    function toggleAddress(isDelivery) {
      const deliveryAddressField = document.getElementById('delivery-address');
      if (isDelivery)
        deliveryAddressField.classList.add('show');
      else
        deliveryAddressField.classList.remove('show');
    }

    // Toggle Credit Card Information fields
    function togglePayment(isOnlinePayment) {
      const creditCardInfo = document.getElementById('credit-card-info');
      if (isOnlinePayment)
        creditCardInfo.classList.add('show');
      else
        creditCardInfo.classList.remove('show');
    }

    function validateOrder() {
      var delivery = document.getElementById("delivery").checked;
      var postcode = document.getElementById("postcode").value;
      var name = document.getElementById("name").value;
      var order = document.getElementById("order").value;
      var billingAddress = document.getElementById("billing-address").value;
      var contactNumber = document.getElementById("contact-number").value;
      var email = document.getElementById("email").value;


      var errMsg = "";
      var result = true;
      var pattern = /^\d{4}$/;

      // check for empty fields

      if (delivery) { // Check postcode only if delivery option is selected
        if (!postcode.match(pattern)) {
          errMsg += "Postcode must be exactly 4 digits.\n";
        }
      }

      if (name == "") {
        errMsg += "name cannot be empty.\n";
      }

      if (order == "") {
        errMsg += "order cannot be empty.\n";
      }

      if (billingAddress == "") {
        errMsg += "billing address cannot be empty.\n";
      }

      if (contactNumber == "") {
        errMsg += "contact number cannot be empty.\n";
      }

      if (email == "") {
        errMsg += "email cannot be empty.\n";
      }



      /* Display error message any error(s) is/are detected */
      if (errMsg != "") {
        alert(errMsg);
        result = false;
      }

      return result;


    }

    // copy delivery address to billing address if filled out
    function copyAddress() {
      const deliveryAddress = document.getElementById("address").value;
      const billingAddress = document.getElementById("billing-address");
      const sameAsDeliveryCheckbox = document.getElementById("same-as-delivery");

      if (sameAsDeliveryCheckbox.checked) {
        if (deliveryAddress === "") {
          alert("Please enter your delivery address first.");
          sameAsDeliveryCheckbox.checked = false;
          billingAddress.value = "";
        } else {
          billingAddress.value = deliveryAddress;
        }
      } else {
        billingAddress.value = "";
      }
    }

    // adjust the length of credit card number field based on user selection
    function updateCardNumberLength() {
      const cardTypeSelect = document.getElementById('card-type');
      const cardNumberInput = document.getElementById('card-number');

      // Get the selected card type
      const selectedCardType = cardTypeSelect.value;

      // Set the maxlength based on the selected card type
      if (selectedCardType === 'amex') {
        cardNumberInput.setAttribute('maxlength', '15');

      } else {
        cardNumberInput.setAttribute('maxlength', '16');

      }
    }



    function init() {
      var orderForm = document.getElementById("order-form");
      orderForm.onsubmit = validateOrder;
      updateCardNumberLength();
    }

    window.onload = init;


  </script>

</body>

</html>